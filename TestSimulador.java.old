package com.facu.simulation.engine;

/**
 * Clase para probar el motor de simulación.
 * Ejecuta una simulación simple y muestra los resultados.
 */
public class TestSimulador {
    
    public static void main(String[] args) {
        // Crear configuración de prueba
        ConfiguracionSimulacion config = new ConfiguracionSimulacion(
            3.0,    // Media de llegadas (3 días)
            0.5,    // Tiempo descarga min
            1.5,    // Tiempo descarga max 
            2,      // 2 muelles
            2,      // 2 grúas (según las especificaciones del problema)
            50,     // 50 días de simulación
            0,      // Mostrar desde día 0
            50      // Mostrar hasta día 50
        );
        
        // Crear y ejecutar simulador
        Simulador simulador = new Simulador(config);
        
        System.out.println("=== Iniciando Simulación ===");
        System.out.println("Configuración:");
        System.out.println("- Media llegadas: " + config.getMediaLlegadas() + " días");
        System.out.println("- Tiempo descarga: Uniforme [" + config.getTiempoDescargaMin() + ", " + config.getTiempoDescargaMax() + "] días");
        System.out.println("- Muelles: " + config.getCantidadMuelles());
        System.out.println("- Grúas: " + config.getCantidadGruas());
        System.out.println("- Días simulación: " + config.getDiasSimulacion() + " días");
        System.out.println();
        
        // Ejecutar simulación
        var resultados = simulador.run();
        
        // Mostrar resultados
        System.out.println("=== Resultados de la Simulación ===");
        System.out.println("Tiempo final: " + String.format("%.2f", simulador.getReloj()) + " días");
        System.out.println("Barcos atendidos: " + resultados.getTotalBarcosAtendidos());
        System.out.println("Barcos generados: " + resultados.getTotalBarcosGenerados());
        System.out.println("Tiempo promedio de permanencia: " + 
                         String.format("%.2f", resultados.getTiempoPermaneciaMedio()) + " días");
        
        // Mostrar algunos vectores de estado
        System.out.println("\n=== Primeros 10 Estados ===");
        System.out.println("Fila | Tiempo  | Evento        | Bahía | Muelles    | Grúas");
        System.out.println("-----|---------|---------------|-------|------------|----------");
        
        int contador = 0;
        for (var filaDTO : resultados.getFilasTabla()) {
            if (contador >= 10) break;
            
            System.out.printf("%4d | %7s | %-13s | %5s | %-10s | %-8s%n",
                contador + 1,
                filaDTO.getReloj(),
                filaDTO.getEvento(),
                filaDTO.getCola(),
                java.util.Arrays.toString(filaDTO.getEstadosMuelles()),
                java.util.Arrays.toString(filaDTO.getEstadosGruas())
            );
            contador++;
        }
        
        System.out.println("\n=== Simulación Completada ===");
    }
}
